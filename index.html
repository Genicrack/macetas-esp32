<!DOCTYPE html>
<html lang="es">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Panel Maceta ESP32</title>
<style>
body { font-family: sans-serif; background: #0b1020; color: white; padding: 20px; }
input, button { padding: 8px; margin: 5px; border-radius: 5px; }
#status { white-space: pre; background: #111; padding: 10px; border-radius: 5px; }
</style>

<h1>üå± Panel Maceta ESP32</h1>
<p>Ingresa la IP de tu ESP32 (ej: <b>192.168.4.1</b> si est√°s conectado a su red):</p>
<input id="ip" placeholder="Ej: 192.168.4.1">
<button onclick="conectar()">Conectar</button>

<h2>Datos de la planta</h2>
<div id="status">Sin datos a√∫n...</div>

<script>
let baseUrl = "";

async function conectar() {
    const ip = document.getElementById("ip").value.trim();
    if (!ip) return alert("Pon√© la IP de la ESP32");
    baseUrl = "http://" + ip;
    obtenerEstado();
    setInterval(obtenerEstado, 3000);
}

async function obtenerEstado() {
    try {
        const r = await fetch(baseUrl + "/api/status");
        if (!r.ok) throw new Error(r.status);
        const j = await r.json();
        document.getElementById("status").textContent = JSON.stringify(j, null, 2);
    } catch (e) {
        document.getElementById("status").textContent = "Error conectando: " + e;
    }
}
</script>
</html>
